@model VirtualHair.Models.UserHairstyle
@{
    ViewData["Title"] = "Edit Look";
}

<div class="container py-4">
    <div class="mx-auto" style="max-width: 720px;">
        <div class="card shadow-sm border-0">
            <div class="card-body p-4">
                <h3 class="mb-3 fw-semibold">Edit Look</h3>
                <p class="text-secondary mb-4">Update your saved look details.</p>

                <form asp-action="Edit" method="post" enctype="multipart/form-data" novalidate>
                    @Html.AntiForgeryToken()
                    <input type="hidden" asp-for="Id" />

                    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

                    <div class="mb-3">
                        <label asp-for="Title" class="form-label">Look name</label>
                        <input asp-for="Title" class="form-control" />
                        <span asp-validation-for="Title" class="text-danger"></span>
                    </div>

                    <div class="mb-3">
                        <label asp-for="HairstyleId" class="form-label">Hairstyle</label>
                        <select asp-for="HairstyleId" class="form-select"
                                asp-items="@(new SelectList(ViewBag.Hairstyles, "Id", "Name", Model?.HairstyleId))">
                            <option value="">-- Select hairstyle --</option>
                        </select>
                        <span asp-validation-for="HairstyleId" class="text-danger"></span>
                    </div>

                    <div class="mb-4">
                        <label asp-for="FacialHairId" class="form-label">Facial hair (optional)</label>
                        <select asp-for="FacialHairId" class="form-select"
                                asp-items="@(new SelectList(ViewBag.FacialHairs, "Id", "Name", Model?.FacialHairId))">
                            <option value="">-- None --</option>
                        </select>
                        <span asp-validation-for="FacialHairId" class="text-danger"></span>
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary px-4">Save Changes</button>
                        <a asp-action="Index" class="btn btn-outline-secondary px-4">Back to Gallery</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Toasts -->
<div class="position-fixed top-0 end-0 p-3" style="z-index: 1080">
    <div id="toastMsg" class="toast align-items-center text-bg-success border-0" role="alert">
        <div class="d-flex">
            <div class="toast-body" id="toastBody">Updated successfully.</div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        (function () {
            const success = '@(TempData["SuccessMessage"] ?? "")';
            const error = '@(TempData["ErrorMessage"] ?? "")';
            if (success || error) {
                const toast = document.getElementById('toastMsg');
                const body = document.getElementById('toastBody');
                if (error) {
                    toast.classList.remove('text-bg-success');
                    toast.classList.add('text-bg-danger');
                    body.textContent = error;
                } else {
                    toast.classList.remove('text-bg-danger');
                    toast.classList.add('text-bg-success');
                    body.textContent = success;
                }
                new bootstrap.Toast(toast, { delay: 3000 }).show();
            }
        })();
    </script>
}
